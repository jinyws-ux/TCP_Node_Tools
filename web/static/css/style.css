/* =========================================
   App UI — Polished Theme (整理版)
   ========================================= */

/* ---------- CSS Variables (Theme Tokens) ---------- */
:root{
  --bg: #f7f8fa;
  --card: #ffffff;
  --muted: #6b7280;         /* gray-500 */
  --muted-2:#9ca3af;        /* gray-400 */
  --text: #1f2937;          /* gray-800 */
  --line: #e5e7eb;          /* gray-200 */

  --primary: #3b82f6;       /* blue-500 */
  --primary-600:#2563eb;    /* blue-600 */
  --primary-50:#eff6ff;     /* blue-50 */

  --success:#22c55e;        /* green-500 */
  --success-600:#16a34a;    /* green-600 */
  --warning:#f59e0b;        /* amber-500 */
  --warning-600:#d97706;
  --danger:#ef4444;         /* red-500 */
  --danger-600:#dc2626;

  --ring: rgba(59,130,246,.25);

  --radius: 10px;
  --radius-sm: 8px;

  --space-1: 6px;
  --space-2: 10px;
  --space-3: 14px;
  --space-4: 18px;
  --space-5: 22px;

  /* 统一控件高度：按钮/下拉/输入同高 */
  --control-height: 40px;   /* 可调 44/48 */
  --control-radius: 8px;
  --font: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;

  --message-slot-height: 96px;
}

/* ---------- Reset & Base ---------- */
*{ margin:0; padding:0; box-sizing:border-box; font-family:var(--font); }
html,body{ height:100%; }
body{ background:var(--bg); color:var(--text); line-height:1.6; }
.container{ max-width:1400px; margin:0 auto; padding:20px; }

header{
  background:var(--card); padding:14px 18px; border-radius:var(--radius);
  margin-bottom:20px; box-shadow:0 2px 10px rgba(0,0,0,.04);
  display:flex; justify-content:space-between; align-items:center;
}
.logo{ display:flex; align-items:center; gap:12px; }
.logo i{ font-size:2.2rem; color:var(--primary); }
.logo h1{ font-size:1.8rem; color:var(--primary); font-weight:700; }

/* ---------- Tabs ---------- */
.tabs{
  display:flex; background:var(--card);
  border-radius:var(--radius); overflow:hidden; margin-bottom:20px;
  box-shadow:0 2px 10px rgba(0,0,0,.06);
}
.tab{
  flex:1; padding:12px 16px; text-align:center; cursor:pointer; font-weight:600;
  color:#4b5563; border-bottom:3px solid transparent; transition:.2s ease;
}
.tab:hover{ background:#eff2f6; }
.tab.active{ color:var(--primary); background:#eef2ff; border-bottom-color:var(--primary); }
.tab-content{
  display:none; background:var(--card); border-radius:var(--radius);
  padding:22px; box-shadow:0 4px 12px rgba(0,0,0,.06); margin-bottom:22px;
}
.tab-content.active{ display:block; animation:fadeIn .3s ease; }
@keyframes fadeIn{ from{opacity:0; transform:translateY(6px);} to{opacity:1; transform:translateY(0);} }

/* ---------- Headings ---------- */
h2{
  color:var(--primary); margin-bottom:14px; padding-bottom:8px;
  border-bottom:2px solid var(--line); font-size:1.6rem;
}

/* ---------- Forms & Controls ---------- */
/* 不影响 checkbox / radio / range */
input:not([type=checkbox]):not([type=radio]):not([type=range]),
select, textarea{
  width:100%;
  padding:0 12px;
  height:var(--control-height);
  background:#fff; border:1px solid #cbd5e1; border-radius:var(--control-radius);
  font-size:14px; transition:.15s;
}
textarea{ min-height:120px; padding:10px 12px; }
input:focus:not([type=checkbox]):not([type=radio]):not([type=range]),
select:focus, textarea:focus{
  outline:none; border-color:var(--primary);
  box-shadow:0 0 0 4px var(--ring);
}

label{ display:block; margin-bottom:6px; font-weight:600; color:#374151; }
.form-group{ margin-bottom:12px; }

/* 行排版 */
.form-row{ display:flex; gap:12px; align-items:flex-end; flex-wrap:wrap; }
.form-row .form-group{ flex:1; min-width:220px; margin-bottom:0; }
.form-row .form-group:last-child{ flex:0 0 auto; min-width:auto; }

/* Checkbox 规格化 */
.checkbox-group{ display:flex; gap:16px; margin:10px 0; }
.checkbox-item{ display:flex; align-items:center; gap:8px; color:#374151; }
.checkbox-item input[type="checkbox"],
#results-body input[type="checkbox"],
#logs-body input[type="checkbox"]{
  width:auto; height:auto; transform:none; accent-color:var(--primary);
}

/* 分析页选择器与右侧按钮对齐（同高、同基线） */
.analyze-header{ display:flex; justify-content:space-between; align-items:flex-end; gap:16px; margin-bottom:16px; }
.analyze-controls{ display:flex; align-items:flex-end; gap:16px; flex-wrap:wrap; }
.analyze-controls-left{ flex:1; min-width:320px; }
.analyze-controls-right{ flex-shrink:0; }
.config-select-group{ display:flex; align-items:flex-end; gap:10px; margin-bottom:0; }
.config-select-group label{ margin:0; white-space:nowrap; font-weight:600; color:#374151; }
.config-select{ height:var(--control-height); min-width:320px; }
.analyze-actions{ display:flex; gap:10px; flex-wrap:wrap; margin-top:0; }
.analyze-actions .btn{ height:var(--control-height); padding:0 14px; }

/* ---------- Buttons ---------- */
.btn{
  display:inline-flex; align-items:center; justify-content:center; gap:6px;
  height:var(--control-height); padding:0 14px; border:1px solid transparent;
  border-radius:var(--control-radius); font-size:14px; font-weight:600; cursor:pointer;
  transition:transform .08s ease, box-shadow .2s, background-color .2s, border-color .2s;
  background:#e5e7eb; color:#111827;
}
.btn i{ margin-right:4px; }
.btn:hover{ transform:translateY(-1px); box-shadow:0 6px 14px rgba(0,0,0,.08); }
.btn:active{ transform:translateY(0); box-shadow:none; }
.btn:disabled{ background:#cbd5e1; color:#6b7280; cursor:not-allowed; box-shadow:none; }

/* Variants */
.btn-primary{ background:var(--primary); color:#fff; }
.btn-primary:hover{ background:var(--primary-600); }
.btn-success{ background:var(--success); color:#fff; }
.btn-success:hover{ background:var(--success-600); }
.btn-secondary{ background:#475569; color:#fff; }
.btn-secondary:hover{ background:#334155; }
.btn-danger{ background:var(--danger); color:#fff; }
.btn-danger:hover{ background:var(--danger-600); }

/* 小按钮（全局基准） */
.btn-sm{ height:36px; padding:0 12px; font-size:12px; }
.btn-block{ display:block; width:100%; }

/* 「更新」态（服务器配置编辑时） */
.btn-update{
  background:linear-gradient(135deg, #22c55e, #16a34a) !important;
  color:#fff !important; border-color:transparent !important;
}
.btn-update:hover{ filter:saturate(1.05) brightness(1.02); }

/* ---------- Cards / Panels ---------- */
.selection-panel{
  background:var(--card); border:1px solid var(--line);
  border-radius:var(--radius); padding:18px; margin-bottom:18px;
}
.selection-header{ margin-bottom:12px; }
.selection-header h3{ margin:0 0 4px 0; color:#334155; font-size:1.3rem; }
.selection-description{ color:var(--muted); font-size:.95rem; }

/* ---------- Messages ---------- */
.message-container{
  position: relative;
  height: var(--message-slot-height);
  overflow-y: auto;              /* 超出内部滚动 */
  padding: 10px;                 /* 固定内边距，避免切换时跳动 */
  margin: 10px 0;
  border-radius: 8px;
  background: #ffffff;
  border: 1px solid var(--line);
  box-shadow: 0 2px 6px rgba(0,0,0,.05);
  /* 不要用大范围 transition: all，避免出现高度动画 */
}
.message-container.has-message{
  background: #fff;
  border-color: var(--line);
}
.message{
  padding: 10px 12px;
  border-radius: 8px;
  margin: 6px 0;
  border-left: 5px solid;  /* 各种类型的色条沿用 */
  box-shadow: 0 2px 6px rgba(0,0,0,.05);
  position: relative;
  animation: slideIn .18s ease-out;
}
@keyframes slideIn{ from{opacity:0; transform:translateY(-6px);} to{opacity:1; transform:translateY(0);} }
.message-close{
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  font-size: 16px;
  cursor: pointer;
  color: #6b7280;
  opacity: .8;
}
.message-close:hover{ opacity:1; color:#374151; }


.message-success{ background:rgba(34,197,94,.08); color:#14532d; border-left-color:#22c55e; }
.message-error{ background:rgba(239,68,68,.08); color:#7f1d1d; border-left-color:#ef4444; }
.message-warning{ background:rgba(245,158,11,.12); color:#78350f; border-left-color:#f59e0b; }
.message-info{ background:rgba(59,130,246,.10); color:#1e40af; border-left-color:#3b82f6; }
.message-persistent{ border-left-width:6px; }

/* ---------- Tables ---------- */
.table-container{
  overflow-x:auto; margin:16px 0; border-radius:var(--radius); border:1px solid var(--line); background:#fff;
}
table{ width:100%; border-collapse:collapse; min-width:800px; }
th, td{ padding:12px 14px; text-align:left; border-bottom:1px solid var(--line); }
th{
  background:#f3f4f6; font-weight:700; color:#374151; position:sticky; top:0; z-index:1;
}
tr:hover{ background:#f9fafb; }

/* 行内操作按钮 */
.action-cell{ display:flex; gap:6px; flex-wrap:wrap; }
.action-btn{
  padding:6px 10px; border:none; border-radius:6px; cursor:pointer; font-size:12px;
  transition:.2s; display:inline-flex; align-items:center; gap:6px; height:32px;
}
.action-btn:hover{ transform:translateY(-1px); box-shadow:0 6px 14px rgba(0,0,0,.08); }
.action-view{ background:var(--primary); color:#fff; }
.action-view:hover{ background:var(--primary-600); }
.action-download{ background:#10b981; color:#fff; }
.action-delete{ background:var(--danger); color:#fff; }
.action-delete:hover{ background:var(--danger-600); }
.action-report{
  background:linear-gradient(135deg, #8b5cf6, #7c3aed); color:#fff;
}
.action-report:hover{ filter:saturate(1.05) brightness(1.03); transform:translateY(-1px); }

/* 状态徽章 */
.status-badge{
  padding:4px 8px; border-radius:999px; font-size:.82rem; font-weight:600; white-space:nowrap;
  border:1px solid;
}
.status-success{ background:rgba(34,197,94,.10); color:#16a34a; border-color:#86efac; }
.status-warning{ background:rgba(245,158,11,.10); color:#d97706; border-color:#fcd34d; }

/* ---------- Server Config Panels ---------- */
/* 左右两列：左=编辑更宽，右=现有配置略窄 */
.config-layout{ display:flex; gap:16px; align-items:flex-start; }
.config-form{
  background:#fff; padding:18px; border-radius:var(--radius);
  box-shadow:0 2px 8px rgba(0,0,0,.06); border:1px solid var(--line);
}
.config-form.editing{ border:2px solid var(--success); box-shadow:0 0 0 4px rgba(34,197,94,.15); }
.config-form.editing .form-header{
  background:linear-gradient(135deg, #22c55e,#16a34a); color:#fff; border-radius:8px; padding:10px 12px; margin:-6px -6px 10px;
}

.config-form-section{ flex:1 1 auto; min-width:520px; }
.config-list-section{ flex:0 0 360px; max-width:420px; }

.config-list{
  background:#fff; padding:18px; border-radius:var(--radius); box-shadow:0 2px 8px rgba(0,0,0,.06);
  max-height:72vh; overflow:auto; border:1px solid var(--line);
}

/* 右侧“现有配置”卡片：上=信息，下=两枚横排大按钮 */
.config-item{
  padding:14px 16px; border-bottom:1px solid var(--line);
  display:flex; flex-direction:column; align-items:stretch; gap:10px;
  transition:background .2s;
}
.config-item:hover{ background:#f8fafc; }

.config-info h3{ margin:0 0 4px 0; color:var(--primary); font-size:1.05rem; }
.config-info p{ margin:2px 0; color:var(--muted); font-size:.92rem; }
.config-info .config-meta{ margin-top:6px; color:var(--muted-2); font-size:12px; }

/* 操作区两列网格 + 大按钮（与下拉同高） */
.config-actions{
  display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:6px;
}
.config-actions .btn, .config-actions .btn-sm{
  height:var(--control-height); padding:0 14px; font-size:14px; border-radius:var(--control-radius);
  display:inline-flex; align-items:center; justify-content:center; line-height:1;
  box-shadow:0 1px 2px rgba(0,0,0,.04);
}
.config-actions .btn:hover{ transform:translateY(-1px); box-shadow:0 4px 12px rgba(0,0,0,.08); }
.config-actions .btn i{ margin-right:6px; }

/* ---------- Message Empty State ---------- */
.message-empty{
  text-align:center;
  color: var(--muted);
  font-style: italic;
  padding: 6px 0;
  opacity:.8;
}

/* ---------- Footer ---------- */
footer{
  text-align:center; padding:18px; color:var(--muted); font-size:.92rem;
  border-top:1px solid var(--line); margin-top:24px;
}

/* ---------- Loading Spinner ---------- */
.loading{
  display:inline-block; width:18px; height:18px; border:3px solid rgba(0,0,0,.08);
  border-radius:50%; border-top-color:var(--primary); animation:spin 1s linear infinite;
}
@keyframes spin{ to{ transform:rotate(360deg); } }

/* ---------- Modal ---------- */
.modal-overlay{
  position:fixed; inset:0; background:rgba(0,0,0,.5); display:none;
  justify-content:center; align-items:center; z-index:9999;
}
.modal-content{
  background:#fff; border-radius:12px; width:90%; max-width:560px; max-height:90vh; overflow-y:auto;
  box-shadow:0 10px 30px rgba(0,0,0,.2); border:1px solid var(--line);
}
.modal-header{
  padding:14px 16px; border-bottom:1px solid var(--line); display:flex; justify-content:space-between; align-items:center;
}
.modal-header h3{ margin:0; font-size:16px; color:#111827; }
.close-btn{ background:transparent; border:none; font-size:22px; cursor:pointer; color:#6b7280; padding:0 6px; }
.close-btn:hover{ color:#ef4444; }
.modal-body{ padding:16px; }
.modal-footer{ padding:12px 16px; border-top:1px solid var(--line); display:flex; justify-content:flex-end; gap:10px; }

/* ---------- Search (global) ---------- */
.global-search{ margin-top:16px; padding-top:16px; border-top:1px solid var(--line); }
.search-box{ position:relative; max-width:520px; margin-bottom:10px; }
.search-box i{ position:absolute; left:12px; top:50%; transform:translateY(-50%); color:var(--muted); z-index:1; }
.search-input{
  width:100%; padding:0 38px 0 36px; height:var(--control-height);
  border:1px solid #cbd5e1; border-radius:999px; font-size:14px; background:#fff;
}
.btn-clear-search{
  position:absolute; right:8px; top:50%; transform:translateY(-50%);
  background:none; border:none; color:var(--muted); cursor:pointer; padding:5px;
  border-radius:50%; width:26px; height:26px; display:flex; align-items:center; justify-content:center;
}
.btn-clear-search:hover{ background:#f3f4f6; color:#374151; }

/* ---------- Parser Config Workspace ---------- */
.parser-three-column{
  display:grid; grid-template-columns:300px 1fr 380px; gap:16px; align-items:start;
}
.parser-left-nav, .parser-middle-edit, .parser-right-json{
  background:#fff; border:1px solid var(--line); border-radius:var(--radius-sm); padding:12px;
}
.parser-left-nav, .parser-middle-edit{ max-height:72vh; overflow:auto; }
.parser-right-json{ max-height:72vh; display:flex; flex-direction:column; }

.parser-nav-top{ display:flex; gap:8px; margin-bottom:8px; }
.parser-search-box{ position:relative; flex:1; }
.parser-search-box input{ padding-left:30px; height:var(--control-height); }
.parser-search-box i{ position:absolute; left:10px; top:50%; transform:translateY(-50%); color:var(--muted); }

.parser-nav-tree ul{ list-style:none; padding-left:0; margin:0; }
.parser-item{
  display:flex; align-items:center; gap:6px; padding:6px 8px; border-radius:8px; cursor:pointer; transition:.15s;
}
.parser-item:hover{ background:#f6f8fa; }
.parser-item.active{ background:var(--primary-50); border:1px solid #bfdbfe; }
.parser-children{ margin-left:18px; border-left:1px dashed #e5e7eb; padding-left:10px; }

.parser-json-header{ display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
.parser-json-preview{
  flex:1; overflow:auto; background:#0b1220; color:#e5edf3;
  font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  font-size:12px; border-radius:8px; padding:10px;
}
.parser-json-tools{ display:flex; justify-content:flex-end; gap:8px; margin-top:8px; }

/* ---------- Responsive ---------- */
@media (max-width:1080px){
  .tabs{ flex-direction:column; }
  .parser-three-column{ grid-template-columns:1fr; }
  .parser-left-nav, .parser-middle-edit, .parser-right-json{ max-height:none; }
  .analyze-header{ flex-direction:column; align-items:stretch; }
  .analyze-controls{ flex-direction:column; align-items:stretch; }
  .analyze-controls-left, .analyze-controls-right{ min-width:100%; }
  .analyze-actions .btn{ width:100%; }
}

@media (max-width:980px){
  .config-layout{ flex-direction:column; }
  .config-form-section, .config-list-section{ flex:1 1 auto; min-width:0; }
  .config-list{ max-height:none; }
}

/* ==== Action Buttons – richer colors (append to the end) ==== */

/* 额外色板 */
:root{
  --teal: #14b8a6;        /* 搜索 */
  --teal-600:#0d9488;
  --cyan:#06b6d4;         /* 刷新 */
  --cyan-600:#0891b2;
  --indigo:#6366f1;       /* 编辑/报告 */
  --indigo-600:#4f46e5;
}

/* 让运行态条纹能被裁切，且不影响其他按钮 */
.btn{ position:relative; overflow:hidden; }

/* 搜索日志 */
.btn-search{
  background: var(--teal); color:#fff;
  min-width: 160px;
  padding: 0 18px;
}
.btn-search:hover{ background: var(--teal-600); }

/* 刷新列表 */
.btn-refresh{
  background: var(--cyan); color:#fff;
}
.btn-refresh:hover{ background: var(--cyan-600); }

/* 开始分析（默认=绿；运行中=橙） */
.btn-analyze{
  background: var(--success); color:#fff;
}
.btn-analyze:hover{ background: var(--success-600); }

/* 运行态：两种写法都支持，二选一使用即可 */
.btn-analyze.is-running,
.btn-analyze[data-state="running"]{
  background: linear-gradient(135deg, var(--warning), var(--warning-600));
  color:#fff;
  animation: pulseGlow 1.2s ease-in-out infinite;
}
/* 轻条纹动效（低调，不刺眼） */
.btn-analyze.is-running::after,
.btn-analyze[data-state="running"]::after{
  content:""; position:absolute; inset:0; pointer-events:none; border-radius:inherit;
  background: repeating-linear-gradient(45deg,
              rgba(255,255,255,.10) 0 10px,
              rgba(255,255,255,0) 10px 20px);
  animation: stripeSlide 1.2s linear infinite;
}

@keyframes pulseGlow{
  0%,100%{ box-shadow:0 0 0 0 rgba(245,158,11,.35); }
  50%   { box-shadow:0 0 0 6px rgba(245,158,11,.18); }
}
@keyframes stripeSlide{
  from{ background-position:0 0; }
  to  { background-position:40px 0; }
}

/* 打开报告目录（和表格里的 .action-report 统一为紫色系渐变） */
.btn-report{
  background: linear-gradient(135deg, var(--indigo), var(--indigo-600));
  color:#fff;
}
.btn-report:hover{ filter:saturate(1.05) brightness(1.03); }

/* 编辑（更醒目的靛蓝，不再灰） */
.btn-edit{
  background: var(--indigo); color:#fff;
}
.btn-edit:hover{ background: var(--indigo-600); }


/* ---------- 分析统计卡片 ---------- */
.analysis-stats-card{
  margin-top:18px;
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:18px;
  background:var(--card);
  box-shadow:0 2px 8px rgba(15,23,42,.05);
}
.analysis-stats-card__header h3{
  margin:0;
  color:#0f172a;
  font-size:1.2rem;
}
.analysis-stats-card__header p{
  margin:4px 0 0;
  color:var(--muted);
  font-size:.9rem;
}
.analysis-stats-body{
  margin-top:12px;
  overflow-x:auto;
}
.analysis-stats-table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}
.analysis-stats-table th,
.analysis-stats-table td{
  padding:8px 10px;
  border:1px solid var(--line);
  text-align:left;
}
.analysis-stats-table th{
  background:var(--primary-50);
  color:#1d4ed8;
  font-weight:600;
}
.analysis-stats-table td:first-child,
.analysis-stats-table th:first-child{
  width:60px;
  text-align:center;
}
